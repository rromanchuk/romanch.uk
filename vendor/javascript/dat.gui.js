// dat.gui@0.7.9 downloaded from https://ga.jspm.io/npm:dat.gui@0.7.9/build/dat.gui.module.js

function ___$insertStyle(e){if(e&&"undefined"!==typeof window){var t=document.createElement("style");t.setAttribute("type","text/css");t.innerHTML=e;document.head.appendChild(t);return e}}function colorToString(e,t){var n=e.__state.conversionName.toString();var o=Math.round(e.r);var i=Math.round(e.g);var a=Math.round(e.b);var s=e.a;var l=Math.round(e.h);var d=e.s.toFixed(1);var u=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){var c=e.hex.toString(16);while(c.length<6)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+o+","+i+","+a+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+a+","+s+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+a+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+a+","+s+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+a+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+a+",a:"+s+"}":"HSV_OBJ"===n?"{h:"+l+",s:"+d+",v:"+u+"}":"HSVA_OBJ"===n?"{h:"+l+",s:"+d+",v:"+u+",a:"+s+"}":"unknown format"}var e=Array.prototype.forEach;var t=Array.prototype.slice;var n={BREAK:{},extend:function extend(e){this.each(t.call(arguments,1),(function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))}),this);return e},defaults:function defaults(e){this.each(t.call(arguments,1),(function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))}),this);return e},compose:function compose(){var e=t.call(arguments);return function(){var n=t.call(arguments);for(var o=e.length-1;o>=0;o--)n=[e[o].apply(this,n)];return n[0]}},each:function each(t,n,o){if(t)if(e&&t.forEach&&t.forEach===e)t.forEach(n,o);else if(t.length===t.length+0){var i=void 0;var a=void 0;for(i=0,a=t.length;i<a;i++)if(i in t&&n.call(o,t[i],i)===this.BREAK)return}else for(var s in t)if(n.call(o,t[s],s)===this.BREAK)return},defer:function defer(e){setTimeout(e,0)},debounce:function debounce(e,t,n){var o=void 0;return function(){var i=this;var a=arguments;function delayed(){o=null;n||e.apply(i,a)}var s=n||!o;clearTimeout(o);o=setTimeout(delayed,t);s&&e.apply(i,a)}},toArray:function toArray(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function isUndefined(e){return void 0===e},isNull:function isNull(e){return null===e},isNaN:function(e){function isNaN(t){return e.apply(this,arguments)}isNaN.toString=function(){return e.toString()};return isNaN}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function isObject(e){return e===Object(e)},isNumber:function isNumber(e){return e===e+0},isString:function isString(e){return e===e+""},isBoolean:function isBoolean(e){return false===e||true===e},isFunction:function isFunction(e){return e instanceof Function}};var o=[{litmus:n.isString,conversions:{THREE_CHAR_HEX:{read:function read(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:colorToString},SIX_CHAR_HEX:{read:function read(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:colorToString},CSS_RGB:{read:function read(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:colorToString},CSS_RGBA:{read:function read(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:colorToString}}},{litmus:n.isNumber,conversions:{HEX:{read:function read(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function write(e){return e.hex}}}},{litmus:n.isArray,conversions:{RGB_ARRAY:{read:function read(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function write(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function read(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function write(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:n.isObject,conversions:{RGBA_OBJ:{read:function read(e){return!!(n.isNumber(e.r)&&n.isNumber(e.g)&&n.isNumber(e.b)&&n.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function write(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function read(e){return!!(n.isNumber(e.r)&&n.isNumber(e.g)&&n.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function write(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function read(e){return!!(n.isNumber(e.h)&&n.isNumber(e.s)&&n.isNumber(e.v)&&n.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function write(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function read(e){return!!(n.isNumber(e.h)&&n.isNumber(e.s)&&n.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function write(e){return{h:e.h,s:e.s,v:e.v}}}}}];var i=void 0;var a=void 0;var s=function interpret(){a=false;var e=arguments.length>1?n.toArray(arguments):arguments[0];n.each(o,(function(t){if(t.litmus(e)){n.each(t.conversions,(function(t,o){i=t.read(e);if(false===a&&false!==i){a=i;i.conversionName=o;i.conversion=t;return n.BREAK}}));return n.BREAK}}));return a};var l=void 0;var d={hsv_to_rgb:function hsv_to_rgb(e,t,n){var o=Math.floor(e/60)%6;var i=e/60-Math.floor(e/60);var a=n*(1-t);var s=n*(1-i*t);var l=n*(1-(1-i)*t);var d=[[n,l,a],[s,n,a],[a,n,l],[a,s,n],[l,a,n],[n,a,s]][o];return{r:255*d[0],g:255*d[1],b:255*d[2]}},rgb_to_hsv:function rgb_to_hsv(e,t,n){var o=Math.min(e,t,n);var i=Math.max(e,t,n);var a=i-o;var s=void 0;var l=void 0;if(0===i)return{h:NaN,s:0,v:0};l=a/i;s=e===i?(t-n)/a:t===i?2+(n-e)/a:4+(e-t)/a;s/=6;s<0&&(s+=1);return{h:360*s,s:l,v:i/255}},rgb_to_hex:function rgb_to_hex(e,t,n){var o=this.hex_with_component(0,2,e);o=this.hex_with_component(o,1,t);o=this.hex_with_component(o,0,n);return o},component_from_hex:function component_from_hex(e,t){return e>>8*t&255},hex_with_component:function hex_with_component(e,t,n){return n<<(l=8*t)|e&~(255<<l)}};var u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var c=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||false;o.configurable=true;"value"in o&&(o.writable=true);Object.defineProperty(e,o.key,o)}}return function(e,t,n){t&&defineProperties(e.prototype,t);n&&defineProperties(e,n);return e}}();var _=function get(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0};var inherits=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)};var possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t};var h=function(){function Color(){classCallCheck(this,Color);this.__state=s.apply(this,arguments);if(false===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}c(Color,[{key:"toString",value:function toString(){return colorToString(this)}},{key:"toHexString",value:function toHexString(){return colorToString(this,true)}},{key:"toOriginal",value:function toOriginal(){return this.__state.conversion.write(this)}}]);return Color}();function defineRGBComponent(e,t,n){Object.defineProperty(e,t,{get:function get$$1(){if("RGB"===this.__state.space)return this.__state[t];h.recalculateRGB(this,t,n);return this.__state[t]},set:function set$$1(e){if("RGB"!==this.__state.space){h.recalculateRGB(this,t,n);this.__state.space="RGB"}this.__state[t]=e}})}function defineHSVComponent(e,t){Object.defineProperty(e,t,{get:function get$$1(){if("HSV"===this.__state.space)return this.__state[t];h.recalculateHSV(this);return this.__state[t]},set:function set$$1(e){if("HSV"!==this.__state.space){h.recalculateHSV(this);this.__state.space="HSV"}this.__state[t]=e}})}h.recalculateRGB=function(e,t,o){if("HEX"===e.__state.space)e.__state[t]=d.component_from_hex(e.__state.hex,o);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");n.extend(e.__state,d.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}};h.recalculateHSV=function(e){var t=d.rgb_to_hsv(e.r,e.g,e.b);n.extend(e.__state,{s:t.s,v:t.v});n.isNaN(t.h)?n.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h};h.COMPONENTS=["r","g","b","h","s","v","hex","a"];defineRGBComponent(h.prototype,"r",2);defineRGBComponent(h.prototype,"g",1);defineRGBComponent(h.prototype,"b",0);defineHSVComponent(h.prototype,"h");defineHSVComponent(h.prototype,"s");defineHSVComponent(h.prototype,"v");Object.defineProperty(h.prototype,"a",{get:function get$$1(){return this.__state.a},set:function set$$1(e){this.__state.a=e}});Object.defineProperty(h.prototype,"hex",{get:function get$$1(){if("HEX"!==this.__state.space){this.__state.hex=d.rgb_to_hex(this.r,this.g,this.b);this.__state.space="HEX"}return this.__state.hex},set:function set$$1(e){this.__state.space="HEX";this.__state.hex=e}});var f=function(){function Controller(e,t){classCallCheck(this,Controller);this.initialValue=e[t];this.domElement=document.createElement("div");this.object=e;this.property=t;this.__onChange=void 0;this.__onFinishChange=void 0}c(Controller,[{key:"onChange",value:function onChange(e){this.__onChange=e;return this}},{key:"onFinishChange",value:function onFinishChange(e){this.__onFinishChange=e;return this}},{key:"setValue",value:function setValue(e){this.object[this.property]=e;this.__onChange&&this.__onChange.call(this,e);this.updateDisplay();return this}},{key:"getValue",value:function getValue(){return this.object[this.property]}},{key:"updateDisplay",value:function updateDisplay(){return this}},{key:"isModified",value:function isModified(){return this.initialValue!==this.getValue()}}]);return Controller}();var p={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]};var m={};n.each(p,(function(e,t){n.each(e,(function(e){m[e]=t}))}));var g=/(\d+(\.\d+)?)px/;function cssValueToPixels(e){if("0"===e||n.isUndefined(e))return 0;var t=e.match(g);return n.isNull(t)?0:parseFloat(t[1])}var b={makeSelectable:function makeSelectable(e,t){if(void 0!==e&&void 0!==e.style){e.onselectstart=t?function(){return false}:function(){};e.style.MozUserSelect=t?"auto":"none";e.style.KhtmlUserSelect=t?"auto":"none";e.unselectable=t?"on":"off"}},makeFullscreen:function makeFullscreen(e,t,o){var i=o;var a=t;n.isUndefined(a)&&(a=true);n.isUndefined(i)&&(i=true);e.style.position="absolute";if(a){e.style.left=0;e.style.right=0}if(i){e.style.top=0;e.style.bottom=0}},fakeEvent:function fakeEvent(e,t,o,i){var a=o||{};var s=m[t];if(!s)throw new Error("Event type "+t+" not supported.");var l=document.createEvent(s);switch(s){case"MouseEvents":var d=a.x||a.clientX||0;var u=a.y||a.clientY||0;l.initMouseEvent(t,a.bubbles||false,a.cancelable||true,window,a.clickCount||1,0,0,d,u,false,false,false,false,0,null);break;case"KeyboardEvents":var c=l.initKeyboardEvent||l.initKeyEvent;n.defaults(a,{cancelable:true,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:void 0,charCode:void 0});c(t,a.bubbles||false,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break;default:l.initEvent(t,a.bubbles||false,a.cancelable||true);break}n.defaults(l,i);e.dispatchEvent(l)},bind:function bind(e,t,n,o){var i=o||false;e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n);return b},unbind:function unbind(e,t,n,o){var i=o||false;e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n);return b},addClass:function addClass(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);if(-1===n.indexOf(t)){n.push(t);e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}}return b},removeClass:function removeClass(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/);var o=n.indexOf(t);if(-1!==o){n.splice(o,1);e.className=n.join(" ")}}else e.className=void 0;return b},hasClass:function hasClass(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||false},getWidth:function getWidth(e){var t=getComputedStyle(e);return cssValueToPixels(t["border-left-width"])+cssValueToPixels(t["border-right-width"])+cssValueToPixels(t["padding-left"])+cssValueToPixels(t["padding-right"])+cssValueToPixels(t.width)},getHeight:function getHeight(e){var t=getComputedStyle(e);return cssValueToPixels(t["border-top-width"])+cssValueToPixels(t["border-bottom-width"])+cssValueToPixels(t["padding-top"])+cssValueToPixels(t["padding-bottom"])+cssValueToPixels(t.height)},getOffset:function getOffset(e){var t=e;var n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft;n.top+=t.offsetTop;t=t.offsetParent}while(t);return n},isActive:function isActive(e){return e===document.activeElement&&(e.type||e.href)}};var v=function(e){inherits(BooleanController,e);function BooleanController(e,t){classCallCheck(this,BooleanController);var n=possibleConstructorReturn(this,(BooleanController.__proto__||Object.getPrototypeOf(BooleanController)).call(this,e,t));var o=n;n.__prev=n.getValue();n.__checkbox=document.createElement("input");n.__checkbox.setAttribute("type","checkbox");function onChange(){o.setValue(!o.__prev)}b.bind(n.__checkbox,"change",onChange,false);n.domElement.appendChild(n.__checkbox);n.updateDisplay();return n}c(BooleanController,[{key:"setValue",value:function setValue(e){var t=_(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"setValue",this).call(this,e);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());this.__prev=this.getValue();return t}},{key:"updateDisplay",value:function updateDisplay(){if(true===this.getValue()){this.__checkbox.setAttribute("checked","checked");this.__checkbox.checked=true;this.__prev=true}else{this.__checkbox.checked=false;this.__prev=false}return _(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"updateDisplay",this).call(this)}}]);return BooleanController}(f);var y=function(e){inherits(OptionController,e);function OptionController(e,t,o){classCallCheck(this,OptionController);var i=possibleConstructorReturn(this,(OptionController.__proto__||Object.getPrototypeOf(OptionController)).call(this,e,t));var a=o;var s=i;i.__select=document.createElement("select");if(n.isArray(a)){var l={};n.each(a,(function(e){l[e]=e}));a=l}n.each(a,(function(e,t){var n=document.createElement("option");n.innerHTML=t;n.setAttribute("value",e);s.__select.appendChild(n)}));i.updateDisplay();b.bind(i.__select,"change",(function(){var e=this.options[this.selectedIndex].value;s.setValue(e)}));i.domElement.appendChild(i.__select);return i}c(OptionController,[{key:"setValue",value:function setValue(e){var t=_(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"setValue",this).call(this,e);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());return t}},{key:"updateDisplay",value:function updateDisplay(){if(b.isActive(this.__select))return this;this.__select.value=this.getValue();return _(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"updateDisplay",this).call(this)}}]);return OptionController}(f);var w=function(e){inherits(StringController,e);function StringController(e,t){classCallCheck(this,StringController);var n=possibleConstructorReturn(this,(StringController.__proto__||Object.getPrototypeOf(StringController)).call(this,e,t));var o=n;function onChange(){o.setValue(o.__input.value)}function onBlur(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}n.__input=document.createElement("input");n.__input.setAttribute("type","text");b.bind(n.__input,"keyup",onChange);b.bind(n.__input,"change",onChange);b.bind(n.__input,"blur",onBlur);b.bind(n.__input,"keydown",(function(e){13===e.keyCode&&this.blur()}));n.updateDisplay();n.domElement.appendChild(n.__input);return n}c(StringController,[{key:"updateDisplay",value:function updateDisplay(){b.isActive(this.__input)||(this.__input.value=this.getValue());return _(StringController.prototype.__proto__||Object.getPrototypeOf(StringController.prototype),"updateDisplay",this).call(this)}}]);return StringController}(f);function numDecimals(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var C=function(e){inherits(NumberController,e);function NumberController(e,t,o){classCallCheck(this,NumberController);var i=possibleConstructorReturn(this,(NumberController.__proto__||Object.getPrototypeOf(NumberController)).call(this,e,t));var a=o||{};i.__min=a.min;i.__max=a.max;i.__step=a.step;n.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step;i.__precision=numDecimals(i.__impliedStep);return i}c(NumberController,[{key:"setValue",value:function setValue(e){var t=e;void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max);void 0!==this.__step&&t%this.__step!==0&&(t=Math.round(t/this.__step)*this.__step);return _(NumberController.prototype.__proto__||Object.getPrototypeOf(NumberController.prototype),"setValue",this).call(this,t)}},{key:"min",value:function min(e){this.__min=e;return this}},{key:"max",value:function max(e){this.__max=e;return this}},{key:"step",value:function step(e){this.__step=e;this.__impliedStep=e;this.__precision=numDecimals(e);return this}}]);return NumberController}(f);function roundToDecimal(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var x=function(e){inherits(NumberControllerBox,e);function NumberControllerBox(e,t,o){classCallCheck(this,NumberControllerBox);var i=possibleConstructorReturn(this,(NumberControllerBox.__proto__||Object.getPrototypeOf(NumberControllerBox)).call(this,e,t,o));i.__truncationSuspended=false;var a=i;var s=void 0;function onChange(){var e=parseFloat(a.__input.value);n.isNaN(e)||a.setValue(e)}function onFinish(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function onBlur(){onFinish()}function onMouseDrag(e){var t=s-e.clientY;a.setValue(a.getValue()+t*a.__impliedStep);s=e.clientY}function onMouseUp(){b.unbind(window,"mousemove",onMouseDrag);b.unbind(window,"mouseup",onMouseUp);onFinish()}function onMouseDown(e){b.bind(window,"mousemove",onMouseDrag);b.bind(window,"mouseup",onMouseUp);s=e.clientY}i.__input=document.createElement("input");i.__input.setAttribute("type","text");b.bind(i.__input,"change",onChange);b.bind(i.__input,"blur",onBlur);b.bind(i.__input,"mousedown",onMouseDown);b.bind(i.__input,"keydown",(function(e){if(13===e.keyCode){a.__truncationSuspended=true;this.blur();a.__truncationSuspended=false;onFinish()}}));i.updateDisplay();i.domElement.appendChild(i.__input);return i}c(NumberControllerBox,[{key:"updateDisplay",value:function updateDisplay(){this.__input.value=this.__truncationSuspended?this.getValue():roundToDecimal(this.getValue(),this.__precision);return _(NumberControllerBox.prototype.__proto__||Object.getPrototypeOf(NumberControllerBox.prototype),"updateDisplay",this).call(this)}}]);return NumberControllerBox}(C);function map(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var S=function(e){inherits(NumberControllerSlider,e);function NumberControllerSlider(e,t,n,o,i){classCallCheck(this,NumberControllerSlider);var a=possibleConstructorReturn(this,(NumberControllerSlider.__proto__||Object.getPrototypeOf(NumberControllerSlider)).call(this,e,t,{min:n,max:o,step:i}));var s=a;a.__background=document.createElement("div");a.__foreground=document.createElement("div");b.bind(a.__background,"mousedown",onMouseDown);b.bind(a.__background,"touchstart",onTouchStart);b.addClass(a.__background,"slider");b.addClass(a.__foreground,"slider-fg");function onMouseDown(e){document.activeElement.blur();b.bind(window,"mousemove",onMouseDrag);b.bind(window,"mouseup",onMouseUp);onMouseDrag(e)}function onMouseDrag(e){e.preventDefault();var t=s.__background.getBoundingClientRect();s.setValue(map(e.clientX,t.left,t.right,s.__min,s.__max));return false}function onMouseUp(){b.unbind(window,"mousemove",onMouseDrag);b.unbind(window,"mouseup",onMouseUp);s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function onTouchStart(e){if(1===e.touches.length){b.bind(window,"touchmove",onTouchMove);b.bind(window,"touchend",onTouchEnd);onTouchMove(e)}}function onTouchMove(e){var t=e.touches[0].clientX;var n=s.__background.getBoundingClientRect();s.setValue(map(t,n.left,n.right,s.__min,s.__max))}function onTouchEnd(){b.unbind(window,"touchmove",onTouchMove);b.unbind(window,"touchend",onTouchEnd);s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}a.updateDisplay();a.__background.appendChild(a.__foreground);a.domElement.appendChild(a.__background);return a}c(NumberControllerSlider,[{key:"updateDisplay",value:function updateDisplay(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);this.__foreground.style.width=100*e+"%";return _(NumberControllerSlider.prototype.__proto__||Object.getPrototypeOf(NumberControllerSlider.prototype),"updateDisplay",this).call(this)}}]);return NumberControllerSlider}(C);var E=function(e){inherits(FunctionController,e);function FunctionController(e,t,n){classCallCheck(this,FunctionController);var o=possibleConstructorReturn(this,(FunctionController.__proto__||Object.getPrototypeOf(FunctionController)).call(this,e,t));var i=o;o.__button=document.createElement("div");o.__button.innerHTML=void 0===n?"Fire":n;b.bind(o.__button,"click",(function(e){e.preventDefault();i.fire();return false}));b.addClass(o.__button,"button");o.domElement.appendChild(o.__button);return o}c(FunctionController,[{key:"fire",value:function fire(){this.__onChange&&this.__onChange.call(this);this.getValue().call(this.object);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]);return FunctionController}(f);var A=function(e){inherits(ColorController,e);function ColorController(e,t){classCallCheck(this,ColorController);var o=possibleConstructorReturn(this,(ColorController.__proto__||Object.getPrototypeOf(ColorController)).call(this,e,t));o.__color=new h(o.getValue());o.__temp=new h(0);var i=o;o.domElement=document.createElement("div");b.makeSelectable(o.domElement,false);o.__selector=document.createElement("div");o.__selector.className="selector";o.__saturation_field=document.createElement("div");o.__saturation_field.className="saturation-field";o.__field_knob=document.createElement("div");o.__field_knob.className="field-knob";o.__field_knob_border="2px solid ";o.__hue_knob=document.createElement("div");o.__hue_knob.className="hue-knob";o.__hue_field=document.createElement("div");o.__hue_field.className="hue-field";o.__input=document.createElement("input");o.__input.type="text";o.__input_textShadow="0 1px 1px ";b.bind(o.__input,"keydown",(function(e){13===e.keyCode&&onBlur.call(this)}));b.bind(o.__input,"blur",onBlur);b.bind(o.__selector,"mousedown",(function(){b.addClass(this,"drag").bind(window,"mouseup",(function(){b.removeClass(i.__selector,"drag")}))}));b.bind(o.__selector,"touchstart",(function(){b.addClass(this,"drag").bind(window,"touchend",(function(){b.removeClass(i.__selector,"drag")}))}));var a=document.createElement("div");n.extend(o.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});n.extend(o.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:o.__field_knob_border+(o.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});n.extend(o.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});n.extend(o.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});n.extend(a.style,{width:"100%",height:"100%",background:"none"});linearGradient(a,"top","rgba(0,0,0,0)","#000");n.extend(o.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"});hueGradient(o.__hue_field);n.extend(o.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:o.__input_textShadow+"rgba(0,0,0,0.7)"});b.bind(o.__saturation_field,"mousedown",fieldDown);b.bind(o.__saturation_field,"touchstart",fieldDown);b.bind(o.__field_knob,"mousedown",fieldDown);b.bind(o.__field_knob,"touchstart",fieldDown);b.bind(o.__hue_field,"mousedown",fieldDownH);b.bind(o.__hue_field,"touchstart",fieldDownH);function fieldDown(e){setSV(e);b.bind(window,"mousemove",setSV);b.bind(window,"touchmove",setSV);b.bind(window,"mouseup",fieldUpSV);b.bind(window,"touchend",fieldUpSV)}function fieldDownH(e){setH(e);b.bind(window,"mousemove",setH);b.bind(window,"touchmove",setH);b.bind(window,"mouseup",fieldUpH);b.bind(window,"touchend",fieldUpH)}function fieldUpSV(){b.unbind(window,"mousemove",setSV);b.unbind(window,"touchmove",setSV);b.unbind(window,"mouseup",fieldUpSV);b.unbind(window,"touchend",fieldUpSV);onFinish()}function fieldUpH(){b.unbind(window,"mousemove",setH);b.unbind(window,"touchmove",setH);b.unbind(window,"mouseup",fieldUpH);b.unbind(window,"touchend",fieldUpH);onFinish()}function onBlur(){var e=s(this.value);if(false!==e){i.__color.__state=e;i.setValue(i.__color.toOriginal())}else this.value=i.__color.toString()}function onFinish(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}o.__saturation_field.appendChild(a);o.__selector.appendChild(o.__field_knob);o.__selector.appendChild(o.__saturation_field);o.__selector.appendChild(o.__hue_field);o.__hue_field.appendChild(o.__hue_knob);o.domElement.appendChild(o.__input);o.domElement.appendChild(o.__selector);o.updateDisplay();function setSV(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__saturation_field.getBoundingClientRect();var n=e.touches&&e.touches[0]||e,o=n.clientX,a=n.clientY;var s=(o-t.left)/(t.right-t.left);var l=1-(a-t.top)/(t.bottom-t.top);l>1?l=1:l<0&&(l=0);s>1?s=1:s<0&&(s=0);i.__color.v=l;i.__color.s=s;i.setValue(i.__color.toOriginal());return false}function setH(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__hue_field.getBoundingClientRect();var n=e.touches&&e.touches[0]||e,o=n.clientY;var a=1-(o-t.top)/(t.bottom-t.top);a>1?a=1:a<0&&(a=0);i.__color.h=360*a;i.setValue(i.__color.toOriginal());return false}return o}c(ColorController,[{key:"updateDisplay",value:function updateDisplay(){var e=s(this.getValue());if(false!==e){var t=false;n.each(h.COMPONENTS,(function(o){if(!n.isUndefined(e[o])&&!n.isUndefined(this.__color.__state[o])&&e[o]!==this.__color.__state[o]){t=true;return{}}}),this);t&&n.extend(this.__color.__state,e)}n.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0;var i=255-o;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"});this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px";this.__temp.s=1;this.__temp.v=1;linearGradient(this.__saturation_field,"left","#fff",this.__temp.toHexString());this.__input.value=this.__color.toString();n.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})}}]);return ColorController}(f);var k=["-moz-","-o-","-webkit-","-ms-",""];function linearGradient(e,t,o,i){e.style.background="";n.each(k,(function(n){e.style.cssText+="background: "+n+"linear-gradient("+t+", "+o+" 0%, "+i+" 100%); "}))}function hueGradient(e){e.style.background="";e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var O={load:function load(e,t){var n=t||document;var o=n.createElement("link");o.type="text/css";o.rel="stylesheet";o.href=e;n.getElementsByTagName("head")[0].appendChild(o)},inject:function inject(e,t){var n=t||document;var o=document.createElement("style");o.type="text/css";o.innerHTML=e;var i=n.getElementsByTagName("head")[0];try{i.appendChild(o)}catch(e){}}};var T='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>';var B=function ControllerFactory(e,t){var o=e[t];return n.isArray(arguments[2])||n.isObject(arguments[2])?new y(e,t,arguments[2]):n.isNumber(o)?n.isNumber(arguments[2])&&n.isNumber(arguments[3])?n.isNumber(arguments[4])?new S(e,t,arguments[2],arguments[3],arguments[4]):new S(e,t,arguments[2],arguments[3]):n.isNumber(arguments[4])?new x(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new x(e,t,{min:arguments[2],max:arguments[3]}):n.isString(o)?new w(e,t):n.isFunction(o)?new E(e,t,""):n.isBoolean(o)?new v(e,t):null};function requestAnimationFrame(e){setTimeout(e,1e3/60)}var N=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||requestAnimationFrame;var H=function(){function CenteredDiv(){classCallCheck(this,CenteredDiv);this.backgroundElement=document.createElement("div");n.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"});b.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");n.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var e=this;b.bind(this.backgroundElement,"click",(function(){e.hide()}))}c(CenteredDiv,[{key:"show",value:function show(){var e=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();n.defer((function(){e.backgroundElement.style.opacity=1;e.domElement.style.opacity=1;e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function hide(){var e=this;var hide=function hide(){e.domElement.style.display="none";e.backgroundElement.style.display="none";b.unbind(e.domElement,"webkitTransitionEnd",hide);b.unbind(e.domElement,"transitionend",hide);b.unbind(e.domElement,"oTransitionEnd",hide)};b.bind(this.domElement,"webkitTransitionEnd",hide);b.bind(this.domElement,"transitionend",hide);b.bind(this.domElement,"oTransitionEnd",hide);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function layout(){this.domElement.style.left=window.innerWidth/2-b.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-b.getHeight(this.domElement)/2+"px"}}]);return CenteredDiv}();var L=___$insertStyle(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");O.inject(L);var R="dg";var D=72;var P=20;var V="Default";var F=function(){try{return!!window.localStorage}catch(e){return false}}();var M=void 0;var I=true;var U=void 0;var G=false;var j=[];var z=function GUI(e){var t=this;var o=e||{};this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);b.addClass(this.domElement,R);this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];o=n.defaults(o,{closeOnTop:false,autoPlace:true,width:GUI.DEFAULT_WIDTH});o=n.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace});n.isUndefined(o.load)?o.load={preset:V}:o.preset&&(o.load.preset=o.preset);n.isUndefined(o.parent)&&o.hideable&&j.push(this);o.resizable=n.isUndefined(o.parent)&&o.resizable;o.autoPlace&&n.isUndefined(o.scrollable)&&(o.scrollable=true);var i=F&&"true"===localStorage.getItem(getLocalStorageHash(this,"isLocal"));var a=void 0;var s=void 0;Object.defineProperties(this,{parent:{get:function get$$1(){return o.parent}},scrollable:{get:function get$$1(){return o.scrollable}},autoPlace:{get:function get$$1(){return o.autoPlace}},closeOnTop:{get:function get$$1(){return o.closeOnTop}},preset:{get:function get$$1(){return t.parent?t.getRoot().preset:o.load.preset},set:function set$$1(e){t.parent?t.getRoot().preset=e:o.load.preset=e;setPresetSelectIndex(this);t.revert()}},width:{get:function get$$1(){return o.width},set:function set$$1(e){o.width=e;setWidth(t,e)}},name:{get:function get$$1(){return o.name},set:function set$$1(e){o.name=e;s&&(s.innerHTML=o.name)}},closed:{get:function get$$1(){return o.closed},set:function set$$1(e){o.closed=e;o.closed?b.addClass(t.__ul,GUI.CLASS_CLOSED):b.removeClass(t.__ul,GUI.CLASS_CLOSED);this.onResize();t.__closeButton&&(t.__closeButton.innerHTML=e?GUI.TEXT_OPEN:GUI.TEXT_CLOSED)}},load:{get:function get$$1(){return o.load}},useLocalStorage:{get:function get$$1(){return i},set:function set$$1(e){if(F){i=e;e?b.bind(window,"unload",a):b.unbind(window,"unload",a);localStorage.setItem(getLocalStorageHash(t,"isLocal"),e)}}}});if(n.isUndefined(o.parent)){this.closed=o.closed||false;b.addClass(this.domElement,GUI.CLASS_MAIN);b.makeSelectable(this.domElement,false);if(F&&i){t.useLocalStorage=true;var l=localStorage.getItem(getLocalStorageHash(this,"gui"));l&&(o.load=JSON.parse(l))}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=GUI.TEXT_CLOSED;b.addClass(this.__closeButton,GUI.CLASS_CLOSE_BUTTON);if(o.closeOnTop){b.addClass(this.__closeButton,GUI.CLASS_CLOSE_TOP);this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])}else{b.addClass(this.__closeButton,GUI.CLASS_CLOSE_BOTTOM);this.domElement.appendChild(this.__closeButton)}b.bind(this.__closeButton,"click",(function(){t.closed=!t.closed}))}else{void 0===o.closed&&(o.closed=true);var d=document.createTextNode(o.name);b.addClass(d,"controller-name");s=addRow(t,d);var u=function onClickTitle(e){e.preventDefault();t.closed=!t.closed;return false};b.addClass(this.__ul,GUI.CLASS_CLOSED);b.addClass(s,"title");b.bind(s,"click",u);o.closed||(this.closed=false)}if(o.autoPlace){if(n.isUndefined(o.parent)){if(I){U=document.createElement("div");b.addClass(U,R);b.addClass(U,GUI.CLASS_AUTO_PLACE_CONTAINER);document.body.appendChild(U);I=false}U.appendChild(this.domElement);b.addClass(this.domElement,GUI.CLASS_AUTO_PLACE)}this.parent||setWidth(t,o.width)}this.__resizeHandler=function(){t.onResizeDebounced()};b.bind(window,"resize",this.__resizeHandler);b.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler);b.bind(this.__ul,"transitionend",this.__resizeHandler);b.bind(this.__ul,"oTransitionEnd",this.__resizeHandler);this.onResize();o.resizable&&addResizeHandle(this);a=function saveToLocalStorage(){F&&"true"===localStorage.getItem(getLocalStorageHash(t,"isLocal"))&&localStorage.setItem(getLocalStorageHash(t,"gui"),JSON.stringify(t.getSaveObject()))};this.saveToLocalStorageIfPossible=a;function resetWidth(){var e=t.getRoot();e.width+=1;n.defer((function(){e.width-=1}))}o.parent||resetWidth()};z.toggleHide=function(){G=!G;n.each(j,(function(e){e.domElement.style.display=G?"none":""}))};z.CLASS_AUTO_PLACE="a";z.CLASS_AUTO_PLACE_CONTAINER="ac";z.CLASS_MAIN="main";z.CLASS_CONTROLLER_ROW="cr";z.CLASS_TOO_TALL="taller-than-window";z.CLASS_CLOSED="closed";z.CLASS_CLOSE_BUTTON="close-button";z.CLASS_CLOSE_TOP="close-top";z.CLASS_CLOSE_BOTTOM="close-bottom";z.CLASS_DRAG="drag";z.DEFAULT_WIDTH=245;z.TEXT_CLOSED="Close Controls";z.TEXT_OPEN="Open Controls";z._keydownHandler=function(e){"text"===document.activeElement.type||e.which!==D&&e.keyCode!==D||z.toggleHide()};b.bind(window,"keydown",z._keydownHandler,false);n.extend(z.prototype,{add:function add(e,t){return _add(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function addColor(e,t){return _add(this,e,t,{color:true})},remove:function remove(e){this.__ul.removeChild(e.__li);this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;n.defer((function(){t.onResize()}))},destroy:function destroy(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&U.removeChild(this.domElement);var e=this;n.each(this.__folders,(function(t){e.removeFolder(t)}));b.unbind(window,"keydown",z._keydownHandler,false);removeListeners(this)},addFolder:function addFolder(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace;if(this.load&&this.load.folders&&this.load.folders[e]){t.closed=this.load.folders[e].closed;t.load=this.load.folders[e]}var n=new z(t);this.__folders[e]=n;var o=addRow(this,n.domElement);b.addClass(o,"folder");return n},removeFolder:function removeFolder(e){this.__ul.removeChild(e.domElement.parentElement);delete this.__folders[e.name];this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name];removeListeners(e);var t=this;n.each(e.__folders,(function(t){e.removeFolder(t)}));n.defer((function(){t.onResize()}))},open:function open(){this.closed=false},close:function close(){this.closed=true},hide:function hide(){this.domElement.style.display="none"},show:function show(){this.domElement.style.display=""},onResize:function onResize(){var e=this.getRoot();if(e.scrollable){var t=b.getOffset(e.__ul).top;var o=0;n.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(o+=b.getHeight(t))}));if(window.innerHeight-t-P<o){b.addClass(e.domElement,z.CLASS_TOO_TALL);e.__ul.style.height=window.innerHeight-t-P+"px"}else{b.removeClass(e.domElement,z.CLASS_TOO_TALL);e.__ul.style.height="auto"}}e.__resize_handle&&n.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}));e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:n.debounce((function(){this.onResize()}),50),remember:function remember(){if(n.isUndefined(M)){M=new H;M.domElement.innerHTML=T}if(this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;n.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&addSaveMenu(e);-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}));this.autoPlace&&setWidth(this,this.width)},getRoot:function getRoot(){var e=this;while(e.parent)e=e.parent;return e},getSaveObject:function getSaveObject(){var e=this.load;e.closed=this.closed;if(this.__rememberedObjects.length>0){e.preset=this.preset;e.remembered||(e.remembered={});e.remembered[this.preset]=getCurrentPreset(this)}e.folders={};n.each(this.__folders,(function(t,n){e.folders[n]=t.getSaveObject()}));return e},save:function save(){this.load.remembered||(this.load.remembered={});this.load.remembered[this.preset]=getCurrentPreset(this);markPresetModified(this,false);this.saveToLocalStorageIfPossible()},saveAs:function saveAs(e){if(!this.load.remembered){this.load.remembered={};this.load.remembered[V]=getCurrentPreset(this,true)}this.load.remembered[e]=getCurrentPreset(this);this.preset=e;addPresetOption(this,e,true);this.saveToLocalStorageIfPossible()},revert:function revert(e){n.each(this.__controllers,(function(t){this.getRoot().load.remembered?recallSavedValue(e||this.getRoot(),t):t.setValue(t.initialValue);t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this);n.each(this.__folders,(function(e){e.revert(e)}));e||markPresetModified(this.getRoot(),false)},listen:function listen(e){var t=0===this.__listening.length;this.__listening.push(e);t&&updateDisplays(this.__listening)},updateDisplay:function updateDisplay(){n.each(this.__controllers,(function(e){e.updateDisplay()}));n.each(this.__folders,(function(e){e.updateDisplay()}))}});function addRow(e,t,n){var o=document.createElement("li");t&&o.appendChild(t);n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o);e.onResize();return o}function removeListeners(e){b.unbind(window,"resize",e.__resizeHandler);e.saveToLocalStorageIfPossible&&b.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function markPresetModified(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function augmentController(e,t,o){o.__li=t;o.__gui=e;n.extend(o,{options:function options(t){if(arguments.length>1){var i=o.__li.nextElementSibling;o.remove();return _add(e,o.object,o.property,{before:i,factoryArgs:[n.toArray(arguments)]})}if(n.isArray(t)||n.isObject(t)){var a=o.__li.nextElementSibling;o.remove();return _add(e,o.object,o.property,{before:a,factoryArgs:[t]})}},name:function name(e){o.__li.firstElementChild.firstElementChild.innerHTML=e;return o},listen:function listen(){o.__gui.listen(o);return o},remove:function remove(){o.__gui.remove(o);return o}});if(o instanceof S){var i=new x(o.object,o.property,{min:o.__min,max:o.__max,step:o.__step});n.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=o[e];var n=i[e];o[e]=i[e]=function(){var e=Array.prototype.slice.call(arguments);n.apply(i,e);return t.apply(o,e)}}));b.addClass(t,"has-slider");o.domElement.insertBefore(i.domElement,o.domElement.firstElementChild)}else if(o instanceof x){var a=function r(t){if(n.isNumber(o.__min)&&n.isNumber(o.__max)){var i=o.__li.firstElementChild.firstElementChild.innerHTML;var a=o.__gui.__listening.indexOf(o)>-1;o.remove();var s=_add(e,o.object,o.property,{before:o.__li.nextElementSibling,factoryArgs:[o.__min,o.__max,o.__step]});s.name(i);a&&s.listen();return s}return t};o.min=n.compose(a,o.min);o.max=n.compose(a,o.max)}else if(o instanceof v){b.bind(t,"click",(function(){b.fakeEvent(o.__checkbox,"click")}));b.bind(o.__checkbox,"click",(function(e){e.stopPropagation()}))}else if(o instanceof E){b.bind(t,"click",(function(){b.fakeEvent(o.__button,"click")}));b.bind(t,"mouseover",(function(){b.addClass(o.__button,"hover")}));b.bind(t,"mouseout",(function(){b.removeClass(o.__button,"hover")}))}else if(o instanceof A){b.addClass(t,"color");o.updateDisplay=n.compose((function(e){t.style.borderLeftColor=o.__color.toString();return e}),o.updateDisplay);o.updateDisplay()}o.setValue=n.compose((function(t){e.getRoot().__preset_select&&o.isModified()&&markPresetModified(e.getRoot(),true);return t}),o.setValue)}function recallSavedValue(e,t){var n=e.getRoot();var o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i){i={};n.__rememberedObjectIndecesToControllers[o]=i}i[t.property]=t;if(n.load&&n.load.remembered){var a=n.load.remembered;var s=void 0;if(a[e.preset])s=a[e.preset];else{if(!a[V])return;s=a[V]}if(s[o]&&void 0!==s[o][t.property]){var l=s[o][t.property];t.initialValue=l;t.setValue(l)}}}}function _add(e,t,n,o){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var i=void 0;if(o.color)i=new A(t,n);else{var a=[t,n].concat(o.factoryArgs);i=B.apply(e,a)}o.before instanceof f&&(o.before=o.before.__li);recallSavedValue(e,i);b.addClass(i.domElement,"c");var s=document.createElement("span");b.addClass(s,"property-name");s.innerHTML=i.property;var l=document.createElement("div");l.appendChild(s);l.appendChild(i.domElement);var d=addRow(e,l,o.before);b.addClass(d,z.CLASS_CONTROLLER_ROW);i instanceof A?b.addClass(d,"color"):b.addClass(d,u(i.getValue()));augmentController(e,d,i);e.__controllers.push(i);return i}function getLocalStorageHash(e,t){return document.location.href+"."+t}function addPresetOption(e,t,n){var o=document.createElement("option");o.innerHTML=t;o.value=t;e.__preset_select.appendChild(o);n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function showHideExplain(e,t){t.style.display=e.useLocalStorage?"block":"none"}function addSaveMenu(e){var t=e.__save_row=document.createElement("li");b.addClass(e.domElement,"has-save");e.__ul.insertBefore(t,e.__ul.firstChild);b.addClass(t,"save-row");var o=document.createElement("span");o.innerHTML="&nbsp;";b.addClass(o,"button gears");var i=document.createElement("span");i.innerHTML="Save";b.addClass(i,"button");b.addClass(i,"save");var a=document.createElement("span");a.innerHTML="New";b.addClass(a,"button");b.addClass(a,"save-as");var s=document.createElement("span");s.innerHTML="Revert";b.addClass(s,"button");b.addClass(s,"revert");var l=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?n.each(e.load.remembered,(function(t,n){addPresetOption(e,n,n===e.preset)})):addPresetOption(e,V,false);b.bind(l,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}));t.appendChild(l);t.appendChild(o);t.appendChild(i);t.appendChild(a);t.appendChild(s);if(F){var d=document.getElementById("dg-local-explain");var u=document.getElementById("dg-local-storage");var c=document.getElementById("dg-save-locally");c.style.display="block";"true"===localStorage.getItem(getLocalStorageHash(e,"isLocal"))&&u.setAttribute("checked","checked");showHideExplain(e,d);b.bind(u,"change",(function(){e.useLocalStorage=!e.useLocalStorage;showHideExplain(e,d)}))}var _=document.getElementById("dg-new-constructor");b.bind(_,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||M.hide()}));b.bind(o,"click",(function(){_.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2);M.show();_.focus();_.select()}));b.bind(i,"click",(function(){e.save()}));b.bind(a,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}));b.bind(s,"click",(function(){e.revert()}))}function addResizeHandle(e){var t=void 0;e.__resize_handle=document.createElement("div");n.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function drag(n){n.preventDefault();e.width+=t-n.clientX;e.onResize();t=n.clientX;return false}function dragStop(){b.removeClass(e.__closeButton,z.CLASS_DRAG);b.unbind(window,"mousemove",drag);b.unbind(window,"mouseup",dragStop)}function dragStart(n){n.preventDefault();t=n.clientX;b.addClass(e.__closeButton,z.CLASS_DRAG);b.bind(window,"mousemove",drag);b.bind(window,"mouseup",dragStop);return false}b.bind(e.__resize_handle,"mousedown",dragStart);b.bind(e.__closeButton,"mousedown",dragStart);e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function setWidth(e,t){e.domElement.style.width=t+"px";e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px");e.__closeButton&&(e.__closeButton.style.width=t+"px")}function getCurrentPreset(e,t){var o={};n.each(e.__rememberedObjects,(function(i,a){var s={};var l=e.__rememberedObjectIndecesToControllers[a];n.each(l,(function(e,n){s[n]=t?e.initialValue:e.getValue()}));o[a]=s}));return o}function setPresetSelectIndex(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function updateDisplays(e){0!==e.length&&N.call(window,(function(){updateDisplays(e)}));n.each(e,(function(e){e.updateDisplay()}))}var $={Color:h,math:d,interpret:s};var X={Controller:f,BooleanController:v,OptionController:y,StringController:w,NumberController:C,NumberControllerBox:x,NumberControllerSlider:S,FunctionController:E,ColorController:A};var W={dom:b};var K={GUI:z};var Y=z;var J={color:$,controllers:X,dom:W,gui:K,GUI:Y};export{Y as GUI,$ as color,X as controllers,J as default,W as dom,K as gui};

