var e={};function render_footnote_anchor_name(e,o,t,n){var r=Number(e[o].meta.id+1).toString();var s="";"string"===typeof n.docId&&(s="-"+n.docId+"-");return s+r}function render_footnote_caption(e,o){var t=Number(e[o].meta.id+1).toString();e[o].meta.subId>0&&(t+=":"+e[o].meta.subId);return"["+t+"]"}function render_footnote_ref(e,o,t,n,r){var s=r.rules.footnote_anchor_name(e,o,t,n,r);var f=r.rules.footnote_caption(e,o,t,n,r);var l=s;e[o].meta.subId>0&&(l+=":"+e[o].meta.subId);return'<sup class="footnote-ref"><a href="#fn'+s+'" id="fnref'+l+'">'+f+"</a></sup>"}function render_footnote_block_open(e,o,t){return(t.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'}function render_footnote_block_close(){return"</ol>\n</section>\n"}function render_footnote_open(e,o,t,n,r){var s=r.rules.footnote_anchor_name(e,o,t,n,r);e[o].meta.subId>0&&(s+=":"+e[o].meta.subId);return'<li id="fn'+s+'" class="footnote-item">'}function render_footnote_close(){return"</li>\n"}function render_footnote_anchor(e,o,t,n,r){var s=r.rules.footnote_anchor_name(e,o,t,n,r);e[o].meta.subId>0&&(s+=":"+e[o].meta.subId);return' <a href="#fnref'+s+'" class="footnote-backref">↩︎</a>'}e=function footnote_plugin(e){var o=e.helpers.parseLinkLabel,t=e.utils.isSpace;e.renderer.rules.footnote_ref=render_footnote_ref;e.renderer.rules.footnote_block_open=render_footnote_block_open;e.renderer.rules.footnote_block_close=render_footnote_block_close;e.renderer.rules.footnote_open=render_footnote_open;e.renderer.rules.footnote_close=render_footnote_close;e.renderer.rules.footnote_anchor=render_footnote_anchor;e.renderer.rules.footnote_caption=render_footnote_caption;e.renderer.rules.footnote_anchor_name=render_footnote_anchor_name;function footnote_def(e,o,n,r){var s,f,l,a,i,c,u,_,d,p,h,k=e.bMarks[o]+e.tShift[o],b=e.eMarks[o];if(k+4>b)return false;if(91!==e.src.charCodeAt(k))return false;if(94!==e.src.charCodeAt(k+1))return false;for(i=k+2;i<b;i++){if(32===e.src.charCodeAt(i))return false;if(93===e.src.charCodeAt(i))break}if(i===k+2)return false;if(i+1>=b||58!==e.src.charCodeAt(++i))return false;if(r)return true;i++;e.env.footnotes||(e.env.footnotes={});e.env.footnotes.refs||(e.env.footnotes.refs={});c=e.src.slice(k+2,i-2);e.env.footnotes.refs[":"+c]=-1;u=new e.Token("footnote_reference_open","",1);u.meta={label:c};u.level=e.level++;e.tokens.push(u);s=e.bMarks[o];f=e.tShift[o];l=e.sCount[o];a=e.parentType;h=i;_=d=e.sCount[o]+i-(e.bMarks[o]+e.tShift[o]);while(i<b){p=e.src.charCodeAt(i);if(!t(p))break;9===p?d+=4-d%4:d++;i++}e.tShift[o]=i-h;e.sCount[o]=d-_;e.bMarks[o]=h;e.blkIndent+=4;e.parentType="footnote";e.sCount[o]<e.blkIndent&&(e.sCount[o]+=e.blkIndent);e.md.block.tokenize(e,o,n,true);e.parentType=a;e.blkIndent-=4;e.tShift[o]=f;e.sCount[o]=l;e.bMarks[o]=s;u=new e.Token("footnote_reference_close","",-1);u.level=--e.level;e.tokens.push(u);return true}function footnote_inline(e,t){var n,r,s,f,l,a=e.posMax,i=e.pos;if(i+2>=a)return false;if(94!==e.src.charCodeAt(i))return false;if(91!==e.src.charCodeAt(i+1))return false;n=i+2;r=o(e,i+1);if(r<0)return false;if(!t){e.env.footnotes||(e.env.footnotes={});e.env.footnotes.list||(e.env.footnotes.list=[]);s=e.env.footnotes.list.length;e.md.inline.parse(e.src.slice(n,r),e.md,e.env,l=[]);f=e.push("footnote_ref","",0);f.meta={id:s};e.env.footnotes.list[s]={content:e.src.slice(n,r),tokens:l}}e.pos=r+1;e.posMax=a;return true}function footnote_ref(e,o){var t,n,r,s,f,l=e.posMax,a=e.pos;if(a+3>l)return false;if(!e.env.footnotes||!e.env.footnotes.refs)return false;if(91!==e.src.charCodeAt(a))return false;if(94!==e.src.charCodeAt(a+1))return false;for(n=a+2;n<l;n++){if(32===e.src.charCodeAt(n))return false;if(10===e.src.charCodeAt(n))return false;if(93===e.src.charCodeAt(n))break}if(n===a+2)return false;if(n>=l)return false;n++;t=e.src.slice(a+2,n-1);if("undefined"===typeof e.env.footnotes.refs[":"+t])return false;if(!o){e.env.footnotes.list||(e.env.footnotes.list=[]);if(e.env.footnotes.refs[":"+t]<0){r=e.env.footnotes.list.length;e.env.footnotes.list[r]={label:t,count:0};e.env.footnotes.refs[":"+t]=r}else r=e.env.footnotes.refs[":"+t];s=e.env.footnotes.list[r].count;e.env.footnotes.list[r].count++;f=e.push("footnote_ref","",0);f.meta={id:r,subId:s,label:t}}e.pos=n;e.posMax=l;return true}function footnote_tail(e){var o,t,n,r,s,f,l,a,i,c,u=false,_={};if(e.env.footnotes){e.tokens=e.tokens.filter((function(e){if("footnote_reference_open"===e.type){u=true;i=[];c=e.meta.label;return false}if("footnote_reference_close"===e.type){u=false;_[":"+c]=i;return false}u&&i.push(e);return!u}));if(e.env.footnotes.list){f=e.env.footnotes.list;l=new e.Token("footnote_block_open","",1);e.tokens.push(l);for(o=0,t=f.length;o<t;o++){l=new e.Token("footnote_open","",1);l.meta={id:o,label:f[o].label};e.tokens.push(l);if(f[o].tokens){a=[];l=new e.Token("paragraph_open","p",1);l.block=true;a.push(l);l=new e.Token("inline","",0);l.children=f[o].tokens;l.content=f[o].content;a.push(l);l=new e.Token("paragraph_close","p",-1);l.block=true;a.push(l)}else f[o].label&&(a=_[":"+f[o].label]);a&&(e.tokens=e.tokens.concat(a));s="paragraph_close"===e.tokens[e.tokens.length-1].type?e.tokens.pop():null;r=f[o].count>0?f[o].count:1;for(n=0;n<r;n++){l=new e.Token("footnote_anchor","",0);l.meta={id:o,subId:n,label:f[o].label};e.tokens.push(l)}s&&e.tokens.push(s);l=new e.Token("footnote_close","",-1);e.tokens.push(l)}l=new e.Token("footnote_block_close","",-1);e.tokens.push(l)}}}e.block.ruler.before("reference","footnote_def",footnote_def,{alt:["paragraph","reference"]});e.inline.ruler.after("image","footnote_inline",footnote_inline);e.inline.ruler.after("footnote_inline","footnote_ref",footnote_ref);e.core.ruler.after("inline","footnote_tail",footnote_tail)};var o=e;export default o;

