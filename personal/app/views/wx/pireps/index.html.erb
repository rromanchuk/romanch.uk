
<%= provide(:page_title, 'All recent aircraft reports' ) %>

<div data-controller="maps" data-maps-geo-json-value="<%= points_wx_pireps_path(format: :json, filter: params[:filter]) %>">
  <div id="map" style="width:100%; height:400px"> </div>
</end>


<%= turbo_stream_from :pireps %>

<%= turbo_frame_tag :pireps do %>
  <div class="card">
    <div class="card-header">
      <nav class="nav nav-pills nav-fill mt-3">
        <%= link_to "All", wx_pireps_path, class: "nav-link #{params[:filter].blank? ? 'active' : ''}", data: {turbo_action: :replace} %>
        <%= link_to "URGENT", wx_pireps_path(filter: 'uua'), class: "nav-link #{params[:filter] == 'uua' ? 'active' : ''}", data: {turbo_action: :replace} %>
        <%= link_to "ROUTINE", wx_pireps_path(filter: 'ua'), class: "nav-link #{params[:filter] == 'ua' ? 'active' : ''}", data: {turbo_action: :replace} %>
        <%= form_with(url: wx_pireps_path, method: :get, data: {controller: "search", search_target: "form", turbo_frame: 'pireps'}, class: 'd-flex') do |f| %>
          <%= f.text_field(:aircraft_ref, class: "form-control", placeholder: "Location ID...", data: {action: 'input->search#submit', search_target: 'input'}) %>
        <% end %>
      </nav>
    </div>
    <div class="card-body">
      <%= render partial: 'wx/pireps/pirep', collection: pireps, cached: true %>
    </div>
    <div class="card-footer text-muted">
      <%# Helper Dependency Updated: Sep 14, 2022 at 4pm %>
      <%= render PagerComponent.new(dr_pagy, previous_path: wx_pireps_path(page: dr_pagy.prev, filter: params[:filter]), next_path: wx_pireps_path(page: dr_pagy.next, filter: params[:filter])) %>
    </div>
  </div>
<% end %>